# :turtle: 数据库秒杀商品库存（悲观锁和乐观锁）
***
##  :elephant: 测试环境 </br>
+ 1：Mysql 8.0.x
+ 2：JdbcTemplate

##  :fish: 测试准备 </br>
+ 1：初始化sql文件夹下的`goods.sql`
+ 2：运行src/java/test/java/**
***
## :honeybee: 锁原理 </br>
+ 1：悲观锁（`Pessimistic-Lock`）又称排他锁，一条线程锁定当前行锁或资源后，其他线程必须等待前一条线程完成释放后才能继续去操作当前资源。
+ 2：乐观锁（`Optimistic-Lock`）实现的原理：几个人同时来操作当前资源或行锁，每个人都拿到一个相同的时间戳或版本号（大家都是一样的令牌），这时第一个人来操作行锁或当前资源，在操作完毕以后修改了当前行锁或资源的时间戳。这时下一个人来操作时候发现时间戳和他第一次拿到的不一样，于是需要重新读取一遍拿到新的令牌进行操作，每个人都得一直匹配自己拿到的时间戳一致。
+ 3：Mysql默认是自动提交，在行锁之前需要开启事务，默认使用`set autocommit=0`（不自动提交），结尾必须`commit`，否则事务会一直处于幻读期。
